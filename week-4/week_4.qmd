---
title: "Week 4 Assignment & Notes"
format: 
    html:
        embed-resources: true
execute:
    echo: true
---

# Week 4 Assignment

```{r}
library(readxl)
```

## Question 1

A Realtor, is analyzing the relationship between the sale price of a home (Price in \$), its square footage (Sqft), the number of bedrooms (Beds), the number of bathrooms (Baths), and a Colonial dummy variable (Colonial equals 1 if a colonial-style home, 0 otherwise). The accompanying data file shows information on 36 recent home sales.

```{r}
myData <- read_excel("../data/Ch7_Q15_Data_File.xlsx")
View(myData)
```

```{r}
model <- lm(Price ~ Sqft + Beds + Baths + Colonial, data = myData); summary(model);
```

Construct the 95% confidence interval for expected price for a 2,500-square-foot, colonial-style home with three bedrooms and two bathrooms.

```{r}
item <- data.frame(Sqft = 2500, Beds = 3, Baths = 2, Colonial = 1)
predict(model, item, level = 0.95, interval = "confidence")
```

Construct the 95% prediction interval for price for a 2,500-square-foot, colonial-style home with three bedrooms and two bathrooms.

```{r}
item <- data.frame(Sqft = 2500, Beds = 3, Baths = 2, Colonial = 1)
predict(model, item, level = 0.95, interval = "prediction")
```

## Question 2

A research analyst is trying to determine whether a firm’s price-earnings (P/E) and price-sales (P/S) ratios can explain the firm’s stock performance over the past year. A P/E ratio is calculated as a firm’s share price compared to the income or profit earned by the firm per share. Generally, a high P/E ratio suggests that investors are expecting higher earnings growth in the future compared to companies with a lower P/E ratio. The P/S ratio is calculated by dividing a firm’s share price by the firm’s revenue per share for the trailing 12 months. In short, investors can use the P/S ratio to determine how much they are paying for a dollar of the firm’s sales rather than a dollar of its earnings (P/E ratio). In general, the lower the P/S ratio, the more attractive the investment. The accompanying data file includes the year-to-date returns (Return in %) and the P/E and P/S ratios (labeled PE and PS, respectively) for 30 firms.

```{r}
myData <- read_excel("../data/Ch7_Q25_Data_File.xlsx")
View(myData)
```

```{r}
model <- lm(Return ~ PE + PS, data = myData); summary(model);
```

```{r}
item <- data.frame(PE = 10, PS = 2)
predict(model, item)
```

## Question 3

Consider the sample regressions for the linear, the logarithmic, the exponential, and the log-log models. For each of the estimated models, predict y when x equals 50.

![](images/Screenshot%202025-10-19%20160513.png){fig-align="center"}

```{r}
# model 1 (linear)
# y_hat = b0 + b1*x
18.52 + 1.68*50
```

```{r}
# model 2 (logarithmic)
# y_hat = b0 + b1*ln(x)
(-6.74 + 29.96*log(50))
```

```{r}
# model 3 (exponential)
# y_hat = exp(b0 + b1*x + se^2/2)
exp(1.48 + 0.06*50 + 0.12**2/2)
```

```{r}
# model 4 (log-log)
# y_hat = exp(b0 + b1*ln(x) + se^2/2)
exp(1.02 + 0.96*log(50) + 0.10**2/2)
```

## Question 4

Several studies have reported lower participation in the science, technology, engineering, and mathematics (STEM) careers among female and minority ethnic group students. The accompanying data file includes information on whether the student has applied to a STEM field (1 if STEM, 0 otherwise), whether or not the student is female (1 if female, 0 otherwise), white (1 if white, 0 otherwise), and Asian (1 if Asian, 0 otherwise). Also included in the survey is the information on the student’s high school GPA and the SAT scores.

```{r}
myData <- read_excel("../data/Ch9_Q13_Data_File.xlsx")
View(myData)
```

```{r}
model <- glm(STEM ~ GPA + SAT + White + Female + Asian, data = myData, family = binomial(link = "logit")); summary(model);
```

Find the predicted probability (in %) that a white male student will apply to a STEM field with GPA = 3.4 and SAT = 1400.

```{r}
item <- data.frame(GPA = 3.4, SAT = 1400, White = 1, Female = 0, Asian = 0)
predict(model, item, type = "response")
```

Find the corresponding probabilities (in %) for an Asian male and a male who is neither white nor Asian.

```{r}
# Asian male
asian_male <- data.frame(GPA = 3.4, SAT = 1400, White = 0, Female = 0, Asian = 1)
prob_asian <- predict(model, newdata = asian_male, type = "response")
prob_asian
```

```{r}
# Male who is neither white nor Asian
other_male <- data.frame(GPA = 3.4, SAT = 1400, White = 0, Female = 0, Asian = 0)
prob_other <- predict(model, newdata = other_male, type = "response")
prob_other
```

Find the predicted probability (in %) that a white female student will apply to a STEM field with GPA = 3.4 and SAT = 1400.

```{r}
item <- data.frame(GPA = 3.4, SAT = 1400, White = 1, Female = 1, Asian = 0)
predict(model, item, type = "response")
```

Find the corresponding probabilities (in %) for an Asian female and a female who is neither white nor Asian.

```{r}
# asian female
item <- data.frame(GPA = 3.4, SAT = 1400, White = 0, Female = 1, Asian = 1)
predict(model, item, type = "response")
```

```{r}
# non white or asian female
item <- data.frame(GPA = 3.4, SAT = 1400, White = 0, Female = 1, Asian = 0)
predict(model, item, type = "response")
```

## Question 5

A logistic regression model is estimated to analyze the probability of complications for male patients resulting from a serious infection. Predictor variables include the patient’s weight and age and whether he is diabetic (Diabetes equals 1 if diabetic, 0 otherwise). The accompanying data file includes information on 260 male patients who had tested positive for a serious infection.

```{r}
myData <- read_excel("../data/Ch9_Q21_Data_File.xlsx")
View(myData)
```

```{r}
model <- glm(Complication ~ Age + Weight + Diabetes, family = binomial(link = "logit"), data = myData); summary(model);
```

Estimate the logistic regression model to find the odds of complications for a 60-year-old diabetic patient with a weight of 180 pounds.

```{r}
item <- data.frame(Age = 60, Diabetes = 1, Weight = 180)
predict(model, item, type = "response")
```

```{r}
# to get odds
0.5005235 / (1 - 0.5005235)
```

Find the corresponding odds if the patient is not diabetic?

```{r}
item <- data.frame(Age = 60, Diabetes = 0, Weight = 180)
predict(model, item, type = "response")
```

```{r}
# to get odds
0.1574263 / (1 - 0.1574263)
```

What is the percentage difference in the odds for a diabetic patient compared to a nondiabetic patient, holding the other variables constant?

```{r}
((1.002096 - 0.1868398) / 0.1868398) * 100
```